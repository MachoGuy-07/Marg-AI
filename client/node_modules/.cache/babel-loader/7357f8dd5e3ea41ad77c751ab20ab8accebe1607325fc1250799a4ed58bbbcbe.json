{"ast":null,"code":"var _s = $RefreshSig$();\n// client/src/components/VoiceAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\nexport default function VoiceAnalyzer({\n  stream,\n  onVoiceScore\n}) {\n  _s();\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const lastEnergyRef = useRef(0);\n  const instabilityRef = useRef(0);\n  useEffect(() => {\n    if (!stream) return;\n    const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n    const source = audioContext.createMediaStreamSource(stream);\n    const analyser = audioContext.createAnalyser();\n    analyser.fftSize = 2048;\n    source.connect(analyser);\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    audioContextRef.current = audioContext;\n    analyserRef.current = analyser;\n    dataArrayRef.current = dataArray;\n    function analyze() {\n      analyser.getByteFrequencyData(dataArray);\n\n      // Compute average energy\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        sum += dataArray[i];\n      }\n      const energy = sum / bufferLength;\n\n      // Measure instability (tremor)\n      const diff = Math.abs(energy - lastEnergyRef.current);\n      instabilityRef.current += diff;\n      lastEnergyRef.current = energy;\n\n      // Normalize tremor score\n      const tremorScore = Math.max(0, 1 - instabilityRef.current / 5000);\n      onVoiceScore(tremorScore);\n      requestAnimationFrame(analyze);\n    }\n    analyze();\n    return () => {\n      audioContext.close();\n    };\n  }, [stream, onVoiceScore]);\n  return null;\n}\n_s(VoiceAnalyzer, \"JozEzfGxWllwUmyB++3Z2wC5JPQ=\");\n_c = VoiceAnalyzer;\nvar _c;\n$RefreshReg$(_c, \"VoiceAnalyzer\");","map":{"version":3,"names":["React","useEffect","useRef","VoiceAnalyzer","stream","onVoiceScore","_s","audioContextRef","analyserRef","dataArrayRef","lastEnergyRef","instabilityRef","audioContext","window","AudioContext","webkitAudioContext","source","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","bufferLength","frequencyBinCount","dataArray","Uint8Array","current","analyze","getByteFrequencyData","sum","i","energy","diff","Math","abs","tremorScore","max","requestAnimationFrame","close","_c","$RefreshReg$"],"sources":["/Users/siva/Desktop/AI-INTERVIEW/client/src/components/VoiceAnalyzer.jsx"],"sourcesContent":["// client/src/components/VoiceAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\n\nexport default function VoiceAnalyzer({ stream, onVoiceScore }) {\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const lastEnergyRef = useRef(0);\n  const instabilityRef = useRef(0);\n\n  useEffect(() => {\n    if (!stream) return;\n\n    const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n    const source = audioContext.createMediaStreamSource(stream);\n    const analyser = audioContext.createAnalyser();\n\n    analyser.fftSize = 2048;\n    source.connect(analyser);\n\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n\n    audioContextRef.current = audioContext;\n    analyserRef.current = analyser;\n    dataArrayRef.current = dataArray;\n\n    function analyze() {\n      analyser.getByteFrequencyData(dataArray);\n\n      // Compute average energy\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        sum += dataArray[i];\n      }\n      const energy = sum / bufferLength;\n\n      // Measure instability (tremor)\n      const diff = Math.abs(energy - lastEnergyRef.current);\n      instabilityRef.current += diff;\n\n      lastEnergyRef.current = energy;\n\n      // Normalize tremor score\n      const tremorScore = Math.max(0, 1 - instabilityRef.current / 5000);\n\n      onVoiceScore(tremorScore);\n\n      requestAnimationFrame(analyze);\n    }\n\n    analyze();\n\n    return () => {\n      audioContext.close();\n    };\n  }, [stream, onVoiceScore]);\n\n  return null;\n}"],"mappings":";AAAA;;AAEA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEhD,eAAe,SAASC,aAAaA,CAAC;EAAEC,MAAM;EAAEC;AAAa,CAAC,EAAE;EAAAC,EAAA;EAC9D,MAAMC,eAAe,GAAGL,MAAM,CAAC,IAAI,CAAC;EACpC,MAAMM,WAAW,GAAGN,MAAM,CAAC,IAAI,CAAC;EAChC,MAAMO,YAAY,GAAGP,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMQ,aAAa,GAAGR,MAAM,CAAC,CAAC,CAAC;EAC/B,MAAMS,cAAc,GAAGT,MAAM,CAAC,CAAC,CAAC;EAEhCD,SAAS,CAAC,MAAM;IACd,IAAI,CAACG,MAAM,EAAE;IAEb,MAAMQ,YAAY,GAAG,KAAKC,MAAM,CAACC,YAAY,IAAID,MAAM,CAACE,kBAAkB,EAAE,CAAC;IAC7E,MAAMC,MAAM,GAAGJ,YAAY,CAACK,uBAAuB,CAACb,MAAM,CAAC;IAC3D,MAAMc,QAAQ,GAAGN,YAAY,CAACO,cAAc,CAAC,CAAC;IAE9CD,QAAQ,CAACE,OAAO,GAAG,IAAI;IACvBJ,MAAM,CAACK,OAAO,CAACH,QAAQ,CAAC;IAExB,MAAMI,YAAY,GAAGJ,QAAQ,CAACK,iBAAiB;IAC/C,MAAMC,SAAS,GAAG,IAAIC,UAAU,CAACH,YAAY,CAAC;IAE9Cf,eAAe,CAACmB,OAAO,GAAGd,YAAY;IACtCJ,WAAW,CAACkB,OAAO,GAAGR,QAAQ;IAC9BT,YAAY,CAACiB,OAAO,GAAGF,SAAS;IAEhC,SAASG,OAAOA,CAAA,EAAG;MACjBT,QAAQ,CAACU,oBAAoB,CAACJ,SAAS,CAAC;;MAExC;MACA,IAAIK,GAAG,GAAG,CAAC;MACX,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGR,YAAY,EAAEQ,CAAC,EAAE,EAAE;QACrCD,GAAG,IAAIL,SAAS,CAACM,CAAC,CAAC;MACrB;MACA,MAAMC,MAAM,GAAGF,GAAG,GAAGP,YAAY;;MAEjC;MACA,MAAMU,IAAI,GAAGC,IAAI,CAACC,GAAG,CAACH,MAAM,GAAGrB,aAAa,CAACgB,OAAO,CAAC;MACrDf,cAAc,CAACe,OAAO,IAAIM,IAAI;MAE9BtB,aAAa,CAACgB,OAAO,GAAGK,MAAM;;MAE9B;MACA,MAAMI,WAAW,GAAGF,IAAI,CAACG,GAAG,CAAC,CAAC,EAAE,CAAC,GAAGzB,cAAc,CAACe,OAAO,GAAG,IAAI,CAAC;MAElErB,YAAY,CAAC8B,WAAW,CAAC;MAEzBE,qBAAqB,CAACV,OAAO,CAAC;IAChC;IAEAA,OAAO,CAAC,CAAC;IAET,OAAO,MAAM;MACXf,YAAY,CAAC0B,KAAK,CAAC,CAAC;IACtB,CAAC;EACH,CAAC,EAAE,CAAClC,MAAM,EAAEC,YAAY,CAAC,CAAC;EAE1B,OAAO,IAAI;AACb;AAACC,EAAA,CAxDuBH,aAAa;AAAAoC,EAAA,GAAbpC,aAAa;AAAA,IAAAoC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}