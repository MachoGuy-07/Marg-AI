{"ast":null,"code":"useEffect(() => {\n  if (!stream) return;\n  const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\n  // ðŸš¨ IMPORTANT: resume on user interaction\n  const resumeAudio = async () => {\n    if (audioContext.state === \"suspended\") {\n      await audioContext.resume();\n    }\n  };\n  resumeAudio();\n  const source = audioContext.createMediaStreamSource(stream);\n  const analyser = audioContext.createAnalyser();\n  analyser.fftSize = 512;\n  source.connect(analyser);\n  const bufferLength = analyser.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n  audioContextRef.current = audioContext;\n  analyserRef.current = analyser;\n  dataArrayRef.current = dataArray;\n  const analyze = () => {\n    analyser.getByteTimeDomainData(dataArray);\n    let sum = 0;\n    for (let i = 0; i < bufferLength; i++) {\n      const v = (dataArray[i] - 128) / 128;\n      sum += v * v;\n    }\n    const rms = Math.sqrt(sum / bufferLength);\n    setVolume(rms);\n    const isSpeaking = rms > 0.02; // ðŸ”§ lowered threshold\n    setSpeaking(isSpeaking);\n    if (rms > 0.06) {\n      setConfidence(\"Strong & confident voice âœ…\");\n    } else if (rms > 0.025) {\n      setConfidence(\"Clear but speak slightly louder ðŸ—£ï¸\");\n    } else {\n      setConfidence(\"Too quiet / hesitant âš ï¸\");\n    }\n    rafRef.current = requestAnimationFrame(analyze);\n  };\n  analyze();\n  return () => {\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    audioContext.close();\n  };\n}, [stream]);","map":{"version":3,"names":["useEffect","stream","audioContext","window","AudioContext","webkitAudioContext","resumeAudio","state","resume","source","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","bufferLength","frequencyBinCount","dataArray","Uint8Array","audioContextRef","current","analyserRef","dataArrayRef","analyze","getByteTimeDomainData","sum","i","v","rms","Math","sqrt","setVolume","isSpeaking","setSpeaking","setConfidence","rafRef","requestAnimationFrame","cancelAnimationFrame","close"],"sources":["/Users/siva/Desktop/AI-INTERVIEW/client/src/components/VoiceAnalyzer.jsx"],"sourcesContent":["useEffect(() => {\n  if (!stream) return;\n\n  const audioContext =\n    new (window.AudioContext || window.webkitAudioContext)();\n\n  // ðŸš¨ IMPORTANT: resume on user interaction\n  const resumeAudio = async () => {\n    if (audioContext.state === \"suspended\") {\n      await audioContext.resume();\n    }\n  };\n  resumeAudio();\n\n  const source = audioContext.createMediaStreamSource(stream);\n  const analyser = audioContext.createAnalyser();\n  analyser.fftSize = 512;\n\n  source.connect(analyser);\n\n  const bufferLength = analyser.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n\n  audioContextRef.current = audioContext;\n  analyserRef.current = analyser;\n  dataArrayRef.current = dataArray;\n\n  const analyze = () => {\n    analyser.getByteTimeDomainData(dataArray);\n\n    let sum = 0;\n    for (let i = 0; i < bufferLength; i++) {\n      const v = (dataArray[i] - 128) / 128;\n      sum += v * v;\n    }\n\n    const rms = Math.sqrt(sum / bufferLength);\n    setVolume(rms);\n\n    const isSpeaking = rms > 0.02; // ðŸ”§ lowered threshold\n    setSpeaking(isSpeaking);\n\n    if (rms > 0.06) {\n      setConfidence(\"Strong & confident voice âœ…\");\n    } else if (rms > 0.025) {\n      setConfidence(\"Clear but speak slightly louder ðŸ—£ï¸\");\n    } else {\n      setConfidence(\"Too quiet / hesitant âš ï¸\");\n    }\n\n    rafRef.current = requestAnimationFrame(analyze);\n  };\n\n  analyze();\n\n  return () => {\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    audioContext.close();\n  };\n}, [stream]);"],"mappings":"AAAAA,SAAS,CAAC,MAAM;EACd,IAAI,CAACC,MAAM,EAAE;EAEb,MAAMC,YAAY,GAChB,KAAKC,MAAM,CAACC,YAAY,IAAID,MAAM,CAACE,kBAAkB,EAAE,CAAC;;EAE1D;EACA,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAIJ,YAAY,CAACK,KAAK,KAAK,WAAW,EAAE;MACtC,MAAML,YAAY,CAACM,MAAM,CAAC,CAAC;IAC7B;EACF,CAAC;EACDF,WAAW,CAAC,CAAC;EAEb,MAAMG,MAAM,GAAGP,YAAY,CAACQ,uBAAuB,CAACT,MAAM,CAAC;EAC3D,MAAMU,QAAQ,GAAGT,YAAY,CAACU,cAAc,CAAC,CAAC;EAC9CD,QAAQ,CAACE,OAAO,GAAG,GAAG;EAEtBJ,MAAM,CAACK,OAAO,CAACH,QAAQ,CAAC;EAExB,MAAMI,YAAY,GAAGJ,QAAQ,CAACK,iBAAiB;EAC/C,MAAMC,SAAS,GAAG,IAAIC,UAAU,CAACH,YAAY,CAAC;EAE9CI,eAAe,CAACC,OAAO,GAAGlB,YAAY;EACtCmB,WAAW,CAACD,OAAO,GAAGT,QAAQ;EAC9BW,YAAY,CAACF,OAAO,GAAGH,SAAS;EAEhC,MAAMM,OAAO,GAAGA,CAAA,KAAM;IACpBZ,QAAQ,CAACa,qBAAqB,CAACP,SAAS,CAAC;IAEzC,IAAIQ,GAAG,GAAG,CAAC;IACX,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGX,YAAY,EAAEW,CAAC,EAAE,EAAE;MACrC,MAAMC,CAAC,GAAG,CAACV,SAAS,CAACS,CAAC,CAAC,GAAG,GAAG,IAAI,GAAG;MACpCD,GAAG,IAAIE,CAAC,GAAGA,CAAC;IACd;IAEA,MAAMC,GAAG,GAAGC,IAAI,CAACC,IAAI,CAACL,GAAG,GAAGV,YAAY,CAAC;IACzCgB,SAAS,CAACH,GAAG,CAAC;IAEd,MAAMI,UAAU,GAAGJ,GAAG,GAAG,IAAI,CAAC,CAAC;IAC/BK,WAAW,CAACD,UAAU,CAAC;IAEvB,IAAIJ,GAAG,GAAG,IAAI,EAAE;MACdM,aAAa,CAAC,4BAA4B,CAAC;IAC7C,CAAC,MAAM,IAAIN,GAAG,GAAG,KAAK,EAAE;MACtBM,aAAa,CAAC,qCAAqC,CAAC;IACtD,CAAC,MAAM;MACLA,aAAa,CAAC,yBAAyB,CAAC;IAC1C;IAEAC,MAAM,CAACf,OAAO,GAAGgB,qBAAqB,CAACb,OAAO,CAAC;EACjD,CAAC;EAEDA,OAAO,CAAC,CAAC;EAET,OAAO,MAAM;IACX,IAAIY,MAAM,CAACf,OAAO,EAAEiB,oBAAoB,CAACF,MAAM,CAACf,OAAO,CAAC;IACxDlB,YAAY,CAACoC,KAAK,CAAC,CAAC;EACtB,CAAC;AACH,CAAC,EAAE,CAACrC,MAAM,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}