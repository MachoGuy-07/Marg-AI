{"ast":null,"code":"var _s = $RefreshSig$();\n// client/src/components/VoiceAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\nexport default function VoiceAnalyzer({\n  stream,\n  onVoiceScore\n}) {\n  _s();\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const lastEnergyRef = useRef(0);\n  const instabilityRef = useRef(0);\n  const animationRef = useRef(null);\n  useEffect(() => {\n    if (!stream) return;\n    const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n    const source = audioContext.createMediaStreamSource(stream);\n    const analyser = audioContext.createAnalyser();\n    analyser.fftSize = 2048;\n    source.connect(analyser);\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    audioContextRef.current = audioContext;\n    analyserRef.current = analyser;\n    dataArrayRef.current = dataArray;\n    function analyze() {\n      analyser.getByteFrequencyData(dataArray);\n\n      // ðŸ”¹ Compute average energy\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        sum += dataArray[i];\n      }\n      const energy = sum / bufferLength;\n\n      // ðŸ”¹ Measure instability (voice tremor)\n      const diff = Math.abs(energy - lastEnergyRef.current);\n      instabilityRef.current += diff;\n      lastEnergyRef.current = energy;\n\n      // ðŸ”¹ Normalize tremor score (0â€“1 range)\n      const tremorScore = Math.max(0, 1 - instabilityRef.current / 5000);\n      if (onVoiceScore) {\n        onVoiceScore(tremorScore);\n      }\n      animationRef.current = requestAnimationFrame(analyze);\n    }\n    analyze();\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, [stream, onVoiceScore]);\n  return null;\n}\n_s(VoiceAnalyzer, \"xHzsRzfeJ3gr7qb2S+zh/w5Vap8=\");\n_c = VoiceAnalyzer;\nvar _c;\n$RefreshReg$(_c, \"VoiceAnalyzer\");","map":{"version":3,"names":["React","useEffect","useRef","VoiceAnalyzer","stream","onVoiceScore","_s","audioContextRef","analyserRef","dataArrayRef","lastEnergyRef","instabilityRef","animationRef","audioContext","window","AudioContext","webkitAudioContext","source","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","bufferLength","frequencyBinCount","dataArray","Uint8Array","current","analyze","getByteFrequencyData","sum","i","energy","diff","Math","abs","tremorScore","max","requestAnimationFrame","cancelAnimationFrame","close","_c","$RefreshReg$"],"sources":["/Users/siva/Desktop/AI-INTERVIEW/client/src/components/VoiceAnalyzer.jsx"],"sourcesContent":["// client/src/components/VoiceAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\n\nexport default function VoiceAnalyzer({ stream, onVoiceScore }) {\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const lastEnergyRef = useRef(0);\n  const instabilityRef = useRef(0);\n  const animationRef = useRef(null);\n\n  useEffect(() => {\n    if (!stream) return;\n\n    const audioContext =\n      new (window.AudioContext || window.webkitAudioContext)();\n\n    const source = audioContext.createMediaStreamSource(stream);\n    const analyser = audioContext.createAnalyser();\n\n    analyser.fftSize = 2048;\n    source.connect(analyser);\n\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n\n    audioContextRef.current = audioContext;\n    analyserRef.current = analyser;\n    dataArrayRef.current = dataArray;\n\n    function analyze() {\n      analyser.getByteFrequencyData(dataArray);\n\n      // ðŸ”¹ Compute average energy\n      let sum = 0;\n      for (let i = 0; i < bufferLength; i++) {\n        sum += dataArray[i];\n      }\n\n      const energy = sum / bufferLength;\n\n      // ðŸ”¹ Measure instability (voice tremor)\n      const diff = Math.abs(energy - lastEnergyRef.current);\n      instabilityRef.current += diff;\n\n      lastEnergyRef.current = energy;\n\n      // ðŸ”¹ Normalize tremor score (0â€“1 range)\n      const tremorScore = Math.max(\n        0,\n        1 - instabilityRef.current / 5000\n      );\n\n      if (onVoiceScore) {\n        onVoiceScore(tremorScore);\n      }\n\n      animationRef.current = requestAnimationFrame(analyze);\n    }\n\n    analyze();\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, [stream, onVoiceScore]);\n\n  return null;\n}"],"mappings":";AAAA;;AAEA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEhD,eAAe,SAASC,aAAaA,CAAC;EAAEC,MAAM;EAAEC;AAAa,CAAC,EAAE;EAAAC,EAAA;EAC9D,MAAMC,eAAe,GAAGL,MAAM,CAAC,IAAI,CAAC;EACpC,MAAMM,WAAW,GAAGN,MAAM,CAAC,IAAI,CAAC;EAChC,MAAMO,YAAY,GAAGP,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMQ,aAAa,GAAGR,MAAM,CAAC,CAAC,CAAC;EAC/B,MAAMS,cAAc,GAAGT,MAAM,CAAC,CAAC,CAAC;EAChC,MAAMU,YAAY,GAAGV,MAAM,CAAC,IAAI,CAAC;EAEjCD,SAAS,CAAC,MAAM;IACd,IAAI,CAACG,MAAM,EAAE;IAEb,MAAMS,YAAY,GAChB,KAAKC,MAAM,CAACC,YAAY,IAAID,MAAM,CAACE,kBAAkB,EAAE,CAAC;IAE1D,MAAMC,MAAM,GAAGJ,YAAY,CAACK,uBAAuB,CAACd,MAAM,CAAC;IAC3D,MAAMe,QAAQ,GAAGN,YAAY,CAACO,cAAc,CAAC,CAAC;IAE9CD,QAAQ,CAACE,OAAO,GAAG,IAAI;IACvBJ,MAAM,CAACK,OAAO,CAACH,QAAQ,CAAC;IAExB,MAAMI,YAAY,GAAGJ,QAAQ,CAACK,iBAAiB;IAC/C,MAAMC,SAAS,GAAG,IAAIC,UAAU,CAACH,YAAY,CAAC;IAE9ChB,eAAe,CAACoB,OAAO,GAAGd,YAAY;IACtCL,WAAW,CAACmB,OAAO,GAAGR,QAAQ;IAC9BV,YAAY,CAACkB,OAAO,GAAGF,SAAS;IAEhC,SAASG,OAAOA,CAAA,EAAG;MACjBT,QAAQ,CAACU,oBAAoB,CAACJ,SAAS,CAAC;;MAExC;MACA,IAAIK,GAAG,GAAG,CAAC;MACX,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGR,YAAY,EAAEQ,CAAC,EAAE,EAAE;QACrCD,GAAG,IAAIL,SAAS,CAACM,CAAC,CAAC;MACrB;MAEA,MAAMC,MAAM,GAAGF,GAAG,GAAGP,YAAY;;MAEjC;MACA,MAAMU,IAAI,GAAGC,IAAI,CAACC,GAAG,CAACH,MAAM,GAAGtB,aAAa,CAACiB,OAAO,CAAC;MACrDhB,cAAc,CAACgB,OAAO,IAAIM,IAAI;MAE9BvB,aAAa,CAACiB,OAAO,GAAGK,MAAM;;MAE9B;MACA,MAAMI,WAAW,GAAGF,IAAI,CAACG,GAAG,CAC1B,CAAC,EACD,CAAC,GAAG1B,cAAc,CAACgB,OAAO,GAAG,IAC/B,CAAC;MAED,IAAItB,YAAY,EAAE;QAChBA,YAAY,CAAC+B,WAAW,CAAC;MAC3B;MAEAxB,YAAY,CAACe,OAAO,GAAGW,qBAAqB,CAACV,OAAO,CAAC;IACvD;IAEAA,OAAO,CAAC,CAAC;IAET,OAAO,MAAM;MACX,IAAIhB,YAAY,CAACe,OAAO,EAAE;QACxBY,oBAAoB,CAAC3B,YAAY,CAACe,OAAO,CAAC;MAC5C;MAEA,IAAIpB,eAAe,CAACoB,OAAO,EAAE;QAC3BpB,eAAe,CAACoB,OAAO,CAACa,KAAK,CAAC,CAAC;MACjC;IACF,CAAC;EACH,CAAC,EAAE,CAACpC,MAAM,EAAEC,YAAY,CAAC,CAAC;EAE1B,OAAO,IAAI;AACb;AAACC,EAAA,CAvEuBH,aAAa;AAAAsC,EAAA,GAAbtC,aAAa;AAAA,IAAAsC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}