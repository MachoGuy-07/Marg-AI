{"ast":null,"code":"var _jsxFileName = \"/Users/siva/Desktop/AI-INTERVIEW/client/src/components/PostureAnalyzer.jsx\",\n  _s = $RefreshSig$();\n// client/src/components/PostureAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\nimport { FaceMesh } from \"@mediapipe/face_mesh\";\nimport { Camera } from \"@mediapipe/camera_utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PostureAnalyzer({\n  onScoreUpdate\n}) {\n  _s();\n  const videoRef = useRef(null);\n  useEffect(() => {\n    const faceMesh = new FaceMesh({\n      locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`\n    });\n    faceMesh.setOptions({\n      maxNumFaces: 1,\n      refineLandmarks: true,\n      minDetectionConfidence: 0.7,\n      minTrackingConfidence: 0.7\n    });\n    let lastEyeRatio = 0;\n    let blinkCount = 0;\n    faceMesh.onResults(results => {\n      if (!results.multiFaceLandmarks) return;\n      const landmarks = results.multiFaceLandmarks[0];\n\n      // =========================\n      // 1Ô∏è‚É£ EYE CONTACT SCORE\n      // =========================\n      const leftEye = landmarks[33];\n      const rightEye = landmarks[263];\n      const noseTip = landmarks[1];\n      const eyeCenterX = (leftEye.x + rightEye.x) / 2;\n      const gazeOffset = Math.abs(noseTip.x - eyeCenterX);\n      const eyeContactScore = 1 - Math.min(gazeOffset * 3, 1);\n\n      // =========================\n      // 2Ô∏è‚É£ HEAD TILT SCORE\n      // =========================\n      const tilt = Math.abs(leftEye.y - rightEye.y);\n      const headTiltScore = 1 - Math.min(tilt * 5, 1);\n\n      // =========================\n      // 3Ô∏è‚É£ BLINK STABILITY\n      // =========================\n      const eyeOpenRatio = Math.abs(landmarks[159].y - landmarks[145].y) + Math.abs(landmarks[386].y - landmarks[374].y);\n      if (lastEyeRatio !== 0 && eyeOpenRatio < lastEyeRatio * 0.6) {\n        blinkCount++;\n      }\n      lastEyeRatio = eyeOpenRatio;\n      const blinkScore = blinkCount < 15 ? 1 : 0.6;\n\n      // =========================\n      // 4Ô∏è‚É£ NERVOUS MOVEMENT\n      // =========================\n      const jaw = landmarks[152];\n      const chinMovement = Math.abs(jaw.x - noseTip.x);\n      const movementScore = 1 - Math.min(chinMovement * 2, 1);\n\n      // =========================\n      // 5Ô∏è‚É£ MICRO-EXPRESSIONS\n      // =========================\n      const leftMouth = landmarks[61];\n      const rightMouth = landmarks[291];\n      const upperLip = landmarks[13];\n      const lowerLip = landmarks[14];\n      const smileWidth = Math.abs(leftMouth.x - rightMouth.x);\n      const lipHeight = Math.abs(upperLip.y - lowerLip.y);\n      const smileScore = Math.min(smileWidth * 4, 1);\n      const stressScore = lipHeight < 0.02 ? 0.6 : 1;\n\n      // =========================\n      // üéØ FINAL CONFIDENCE SCORE\n      // =========================\n      const finalScore = eyeContactScore * 0.35 + headTiltScore * 0.15 + blinkScore * 0.15 + movementScore * 0.15 + smileScore * 0.1 + stressScore * 0.1;\n      onScoreUpdate(finalScore);\n    });\n    const camera = new Camera(videoRef.current, {\n      onFrame: async () => {\n        await faceMesh.send({\n          image: videoRef.current\n        });\n      },\n      width: 640,\n      height: 480\n    });\n    camera.start();\n    return () => {\n      camera.stop();\n    };\n  }, [onScoreUpdate]);\n  return /*#__PURE__*/_jsxDEV(\"video\", {\n    ref: videoRef,\n    autoPlay: true,\n    playsInline: true,\n    muted: true,\n    style: {\n      width: \"100%\",\n      borderRadius: 16\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this);\n}\n_s(PostureAnalyzer, \"PdMsmLAy5JKU3vCrhAlqGYQfKuA=\");\n_c = PostureAnalyzer;\nvar _c;\n$RefreshReg$(_c, \"PostureAnalyzer\");","map":{"version":3,"names":["React","useEffect","useRef","FaceMesh","Camera","jsxDEV","_jsxDEV","PostureAnalyzer","onScoreUpdate","_s","videoRef","faceMesh","locateFile","file","setOptions","maxNumFaces","refineLandmarks","minDetectionConfidence","minTrackingConfidence","lastEyeRatio","blinkCount","onResults","results","multiFaceLandmarks","landmarks","leftEye","rightEye","noseTip","eyeCenterX","x","gazeOffset","Math","abs","eyeContactScore","min","tilt","y","headTiltScore","eyeOpenRatio","blinkScore","jaw","chinMovement","movementScore","leftMouth","rightMouth","upperLip","lowerLip","smileWidth","lipHeight","smileScore","stressScore","finalScore","camera","current","onFrame","send","image","width","height","start","stop","ref","autoPlay","playsInline","muted","style","borderRadius","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/siva/Desktop/AI-INTERVIEW/client/src/components/PostureAnalyzer.jsx"],"sourcesContent":["// client/src/components/PostureAnalyzer.jsx\n\nimport React, { useEffect, useRef } from \"react\";\nimport { FaceMesh } from \"@mediapipe/face_mesh\";\nimport { Camera } from \"@mediapipe/camera_utils\";\n\nexport default function PostureAnalyzer({ onScoreUpdate }) {\n  const videoRef = useRef(null);\n\n  useEffect(() => {\n    const faceMesh = new FaceMesh({\n      locateFile: (file) =>\n        `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`,\n    });\n\n    faceMesh.setOptions({\n      maxNumFaces: 1,\n      refineLandmarks: true,\n      minDetectionConfidence: 0.7,\n      minTrackingConfidence: 0.7,\n    });\n\n    let lastEyeRatio = 0;\n    let blinkCount = 0;\n\n    faceMesh.onResults((results) => {\n      if (!results.multiFaceLandmarks) return;\n\n      const landmarks = results.multiFaceLandmarks[0];\n\n      // =========================\n      // 1Ô∏è‚É£ EYE CONTACT SCORE\n      // =========================\n      const leftEye = landmarks[33];\n      const rightEye = landmarks[263];\n      const noseTip = landmarks[1];\n\n      const eyeCenterX = (leftEye.x + rightEye.x) / 2;\n      const gazeOffset = Math.abs(noseTip.x - eyeCenterX);\n\n      const eyeContactScore = 1 - Math.min(gazeOffset * 3, 1);\n\n      // =========================\n      // 2Ô∏è‚É£ HEAD TILT SCORE\n      // =========================\n      const tilt = Math.abs(leftEye.y - rightEye.y);\n      const headTiltScore = 1 - Math.min(tilt * 5, 1);\n\n      // =========================\n      // 3Ô∏è‚É£ BLINK STABILITY\n      // =========================\n      const eyeOpenRatio =\n        Math.abs(landmarks[159].y - landmarks[145].y) +\n        Math.abs(landmarks[386].y - landmarks[374].y);\n\n      if (lastEyeRatio !== 0 && eyeOpenRatio < lastEyeRatio * 0.6) {\n        blinkCount++;\n      }\n\n      lastEyeRatio = eyeOpenRatio;\n\n      const blinkScore = blinkCount < 15 ? 1 : 0.6;\n\n      // =========================\n      // 4Ô∏è‚É£ NERVOUS MOVEMENT\n      // =========================\n      const jaw = landmarks[152];\n      const chinMovement = Math.abs(jaw.x - noseTip.x);\n      const movementScore = 1 - Math.min(chinMovement * 2, 1);\n\n      // =========================\n      // 5Ô∏è‚É£ MICRO-EXPRESSIONS\n      // =========================\n      const leftMouth = landmarks[61];\n      const rightMouth = landmarks[291];\n      const upperLip = landmarks[13];\n      const lowerLip = landmarks[14];\n\n      const smileWidth = Math.abs(leftMouth.x - rightMouth.x);\n      const lipHeight = Math.abs(upperLip.y - lowerLip.y);\n\n      const smileScore = Math.min(smileWidth * 4, 1);\n      const stressScore = lipHeight < 0.02 ? 0.6 : 1;\n\n      // =========================\n      // üéØ FINAL CONFIDENCE SCORE\n      // =========================\n      const finalScore =\n        eyeContactScore * 0.35 +\n        headTiltScore * 0.15 +\n        blinkScore * 0.15 +\n        movementScore * 0.15 +\n        smileScore * 0.1 +\n        stressScore * 0.1;\n\n      onScoreUpdate(finalScore);\n    });\n\n    const camera = new Camera(videoRef.current, {\n      onFrame: async () => {\n        await faceMesh.send({ image: videoRef.current });\n      },\n      width: 640,\n      height: 480,\n    });\n\n    camera.start();\n\n    return () => {\n      camera.stop();\n    };\n  }, [onScoreUpdate]);\n\n  return (\n    <video\n      ref={videoRef}\n      autoPlay\n      playsInline\n      muted\n      style={{\n        width: \"100%\",\n        borderRadius: 16,\n      }}\n    />\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}